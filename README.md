# Compartmental models in epidemiology 疫学における区画モデル

過去にAIを用いたデング熱の感染拡大予測を経験やcovid-19の流行を機に、疫学における区画モデルに興味を持った。そこで**このレポジトリでは、SIRモデルを代表とする疫学における区画モデルについて学習した内容と、Pythonを用いたモデルの作成とシミュレーションを行った結果を記録する。**

## 感染症予測モデル

病気の流行予測と対策を目的に、数理モデルが活用されてきた。その例として、SIRモデルを取り上げる。

**SIRモデルは、伝染病・感染症の短期的な流行プロセスを決定論的に説明する基本モデル**である。モデルの名称は、モデルの変数名のSusceptible(感受性保持者・未感染者), Infectious(感染者), Recovered(免疫保持者・隔離者)の頭文字に起因する。1927年　W.O. KermackとA.G. McKendrickの論文で初めて紹介された。

SIRモデルでは、全体人口を次の集団に分類し、時間に関する各集団の人口増減を微分方程式で表す。　

- **S(Susceptible)** : 伝染病に対する免疫がない者。感染可能者。
- **I Infectious)**：感染により発病し、感染可能者(S)への伝染可能な者。感染者。
- **R (Removed)** : 発病から回復し、免疫を獲得したもの。あるいは発病から回復できず死亡した者。（このモデルのシステムから排除されるため、Removedと呼ばれる。）

<div align="center">
    <img src="https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F208980%2F7c5e9859-7e6b-02db-696e-b3ce2e261c3c.png?ixlib=rb-4.0.0&auto=format&gif-q=60&q=75&w=1400&fit=max&s=90cf1c23da2db98d1b312d7df738d12c" width=40%>
</div>

各集団の人口増減は、次の微分方程式で表される。

$$
\begin{array}{l}\frac{d S}{d t}=-\beta S I \\ \frac{d I}{d t}=\beta S I-\gamma I \\ \frac{d R}{d t}=\gamma I\end{array}
$$

$$
\begin{array}{ll}S: \text { 感染可能者 } & \text { (Susceptible) } \\ I: \text { 感染者 } & \text { (Infectious) } \\ R: \text { 感染後死亡者、もしくは免疫を獲得した者 } \\ \beta: \text { 感染率 } & \text { (The infectious rate) } \quad[1 / d a y] \\ \gamma: \text { 除去率 } & \text { (The Recovery rate) }[1 / d a y]\end{array}
$$

このように数式化することで、数理モデルを実際に観測された流行データのフィッティングさせ、得られたパラメータから疾病発生・拡大の原因を解釈、また流行を予測できるようになる。[1]



## Models

疫学における区画モデルは多く提案されている。そこで、その調査と共に、ある感染症の拡大を仮定し、以下のモデルを用いたPythonによるシミュレーションを行なった。**models/SIR.ipynb** 参照。

- SIR Model (Vanilla model)
- SIS Model
- SIR Model + Population Movement
- SIRS Model (SIR Model + Immune Loss)
- SIR Model + Birth + Death
- SIRD Model
- SEIS Model
- SIR-F Model
- SIQR Model
- SEIQJR Model



## 微分方程式

### 微分方程式

通常の方程式ではある式をみたす変数を見つけるが、微分方程式は未知関数の導関数が現れる方程式でその導関数をみたす方程式を解とする問題である。

つまり、未知関数の導関数からその未知関数を求める式である。

$$
    \frac{dy}{dx}=2x
$$
上の場合、$y$ が未知関数である。

### なぜ微分方程式を使用するのか

微分方程式を用いるのは、なぜならば、ある現象を表現する関数を直接知ることができない場合が多いからである。
物理や経済の基本法則を数学的に書き直して未知関数の変化率に関する情報を得て、それから未知関数を見つける必要がある。

例えば、高校物理で頻繁に目にする問題として「物体を垂直に投げて落ちてくる様子」に関する問いを考える。公式として、物体の速度・位置を習うのでそれらでその問題における物体の速度と位置を求めることが可能である。またさらに難易度を上げて、より現実世界に近い状況を考えようとすると空気抵抗を考慮しなければならない。これも同様に空気抵抗の公式を追加するだけで解ける。

しかし、現実世界における物体の運動には、気圧による空気抵抗の変化など、あらゆる自然の振る舞いを考えなければならない。そうなると、登場する式が増え、また新たな式を定義し追加する、を繰り返して最終的には関係する自然現象を全て数式化し追加する必要がある。つまりは不可能である。

そこで変化量に目を当てる。自然の振る舞いの非常に多くが変化量（微分量）と関係している。自然現象は変化するものであり、もし変化のない世界であると、例えば宇宙は無のままで人類は存在しないと言える。つまり自然現象は、ある作用に対する変化あるいは変化に対する応答のつながりとして表される。

上の物体の運動の例では、時間や位置で速度の大きさが変化し、速度が変化すると抵抗力も変化している。変化やその間のつながりを記述する、広く言うと自然の振る舞いを数式で表すためには微分量の組み合わせの式が簡単で一般性がある。これを微分方程式と言う。[2]

微分方程式は「変化の仕組みを表す」あるいは変化同士のつながりを表す式である。物体の変化の仕方を考えることで、その挙動を示す関数を求める、といった方針である。



## 数理モデル

数理モデルとは、現実にある「特定の動きや現象」を簡略化し、物理法則にしたがって数式に置き換えるたものである。数理モデルが現象を定性的に再現できれば，数理モデルを解析することで，現象の起因となる原理を理論から発見・解釈することが期待できる。

また、一度数式に置き換えれば、パラメーターに数値を入力したり、変更するだけで、簡単にシミュレーションできるようになる。パラメーターを変えるだけで簡単に試行錯誤できる。

数理モデルの研究自体は、数学や物理にて数式を扱うことになるが、活用される分野は幅広く及んでいる。例えば、工学や物理学、電子回路、機械工学、生物、気象、社会経済、免疫、宇宙天文など、身の回りの事象すべてが対象である。



## 基本再生産数

SIRモデルにおいて、$\frac{d I}{d t}=(\beta S-\gamma) I>0$ であれば、感染人口が増加（伝染病の侵入条件）する。

つまり、初期感受性人口密度 $S(0)$において、
$$
S(0)>\gamma/\beta \\
S(0) \beta/\gamma > 1
$$
であれば伝染病は拡大する。

$S(0) \simeq N$より、伝染病の基本再生産数: $R_{0} = N\beta/\gamma$ となる。

同様に、他モデルでも$\frac{d I}{d t}$ を考えることで基本再生産数を求めることができる。



## 参考文献

[1] [感染病の数学予測モデルの紹介(SIRモデル)](https://qiita.com/kotai2003/items/3078f4095c3e94e5325c)

[2] [微分方程式とは・微分方程式を使う理由](https://www.ccn.yamanashi.ac.jp/~kondoh/why-we-learn-deq.pdf)
